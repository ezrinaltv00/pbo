<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>MedMinder</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;

  /* BACKGROUND PINK + POLA KARTUN */
  background-color: #ffc0d9;
  background-image:
    radial-gradient(circle at 20% 20%, rgba(255,255,255,0.25) 2%, transparent 2%),
    radial-gradient(circle at 80% 30%, rgba(255,255,255,0.25) 2%, transparent 2%),
    radial-gradient(circle at 40% 70%, rgba(255,255,255,0.25) 2%, transparent 2%),
    radial-gradient(circle at 70% 80%, rgba(255,255,255,0.25) 2%, transparent 2%);
  background-size: 120px 120px;
}

.health-icons {
  position: fixed;
  inset: 0;
  pointer-events: none;
  font-size: 40px;
  opacity: 0.15;
}

.health-icons span {
  position: absolute;
}

.health-icons span:nth-child(1){top:10%;left:10%;}
.health-icons span:nth-child(2){top:20%;right:15%;}
.health-icons span:nth-child(3){bottom:25%;left:15%;}
.health-icons span:nth-child(4){bottom:15%;right:20%;}
.health-icons span:nth-child(5){top:45%;left:5%;}
.health-icons span:nth-child(6){top:55%;right:5%;}

.box {
  background: #ffffff;
  width: 360px;
  padding: 25px;
  border-radius: 22px;
  box-shadow: 0 15px 30px rgba(0,0,0,0.25);
  text-align: center;
  position: relative;
  z-index: 2;
}

h2 {
  margin-bottom: 5px;
}

.subtitle {
  font-size: 13px;
  color: #777;
  margin-bottom: 15px;
}

.icons {
  font-size: 32px;
  margin-bottom: 15px;
}

input, select {
  width: 100%;
  padding: 10px;
  margin: 7px 0;
  border-radius: 10px;
  border: 1px solid #ccc;
}

button {
  width: 100%;
  padding: 10px;
  border: none;
  border-radius: 12px;
  font-weight: bold;
  cursor: pointer;
  margin-top: 8px;
}

.primary {
  background: #ff5fa2;
  color: white;
}

.secondary {
  background: #ffe1ee;
}

.danger {
  background: #e53935;
  color: white;
}

.card {
  background: #fff1f7;
  padding: 10px;
  border-radius: 12px;
  margin-bottom: 8px;
  font-size: 14px;
}

.card.done {
  opacity: 0.6;
  text-decoration: line-through;
}

small {
  color: #666;
}
</style>
</head>

<body>

<!-- ORNAMEN KARTUN KESEHATAN -->
<div class="health-icons">
  <span>ğŸ©º</span>
  <span>ğŸ’Š</span>
  <span>ğŸŒ¡ï¸</span>
  <span>ğŸ©¹</span>
  <span>ğŸ’‰</span>
  <span>ğŸ¥</span>
</div>

<div class="box" id="app"></div>

<script>
class MedMinder {
  constructor(id){
    this.app = document.getElementById(id);
    this.showHome();
  }

  showHome(){
    this.app.innerHTML = `
      <h2>MedMinder</h2>
      <div class="icons">ğŸ©º ğŸ’Š ğŸŒ¡ï¸</div>
      <div class="subtitle">Pantau jadwal minum obat dengan mudah</div>
      <button class="primary" onclick="app.renderLogin()">Login</button>
      <button class="secondary" onclick="app.renderRegister()">Daftar</button>
    `;
  }

  renderRegister(){
    this.app.innerHTML = `
      <h2>Daftar Akun</h2>
      <div class="icons">ğŸ’‰ ğŸ’Š</div>
      <input id="regUser" placeholder="Username">
      <input id="regPass" type="password" placeholder="Password">
      <button class="primary" onclick="app.register()">Daftar</button>
      <button class="secondary" onclick="app.showHome()">Kembali</button>
    `;
  }

  register(){
    const u = regUser.value.trim();
    const p = regPass.value.trim();
    if(!u || !p) return alert("Data tidak lengkap");

    let users = JSON.parse(localStorage.getItem("users")) || [];
    if(users.find(x=>x.username===u))
      return alert("Username sudah ada");

    users.push({username:u,password:p});
    localStorage.setItem("users", JSON.stringify(users));
    alert("Berhasil daftar, silakan login");
    this.renderLogin();
  }

  renderLogin(){
    this.app.innerHTML = `
      <h2>Login</h2>
      <div class="icons">ğŸ©¹ ğŸ©º</div>
      <input id="username" placeholder="Username">
      <input id="password" type="password" placeholder="Password">
      <button class="primary" onclick="app.login()">Login</button>
      <button class="secondary" onclick="app.showHome()">Kembali</button>
    `;
  }

  login(){
    const u = username.value.trim();
    const p = password.value.trim();
    const users = JSON.parse(localStorage.getItem("users")) || [];

    const found = users.find(x=>x.username===u && x.password===p);
    if(!found) return alert("Login gagal");

    this.currentUser = u;
    if(!localStorage.getItem(u+"_meds"))
      localStorage.setItem(u+"_meds","[]");

    this.renderDashboard();
  }

  renderDashboard(){
    this.app.innerHTML = `
      <h2>Dashboard</h2>
      <div class="icons">ğŸ’Š ğŸ“‹</div>
      <small>Halo <b>${this.currentUser}</b></small>
      <button class="secondary" onclick="app.renderAdd()">+ Tambah Obat</button>
      <div id="list"></div>
      <button class="danger" onclick="app.logout()">Logout</button>
    `;
    this.renderList();
  }

  renderAdd(){
    this.app.innerHTML = `
      <h2>Tambah Obat</h2>
      <div class="icons">ğŸ’Š</div>
      <input id="nama" placeholder="Nama Obat">
      <select id="aturan">
        <option>Sebelum Makan</option>
        <option>Sesudah Makan</option>
      </select>
      <select id="freq">
        <option value="1">1x Sehari</option>
        <option value="2">2x Sehari</option>
        <option value="3">3x Sehari</option>
      </select>
      <button class="primary" onclick="app.save()">Simpan</button>
      <button class="secondary" onclick="app.renderDashboard()">Kembali</button>
    `;
  }

  save(){
    if(!nama.value) return alert("Nama obat wajib diisi");
    const meds = JSON.parse(localStorage.getItem(this.currentUser+"_meds"));
    meds.push({
      nama:nama.value,
      aturan:aturan.value,
      freq:freq.value,
      time:new Date().toLocaleString(),
      done:false
    });
    localStorage.setItem(this.currentUser+"_meds",JSON.stringify(meds));
    this.renderDashboard();
  }

  renderList(){
    const list = document.getElementById("list");
    const meds = JSON.parse(localStorage.getItem(this.currentUser+"_meds"));
    list.innerHTML = meds.length ? "" : "<small>Belum ada obat</small>";

    meds.forEach((m,i)=>{
      const div = document.createElement("div");
      div.className = "card"+(m.done?" done":"");
      div.innerHTML = `
        <b>${m.nama}</b><br>
        ${m.freq}x â€¢ ${m.aturan}<br>
        <small>${m.time}</small><br>
        <button class="secondary" onclick="app.toggle(${i})">
          ${m.done?"Batal":"âœ” Sudah"}
        </button>
      `;
      list.appendChild(div);
    });
  }

  toggle(i){
    const meds = JSON.parse(localStorage.getItem(this.currentUser+"_meds"));
    meds[i].done = !meds[i].done;
    localStorage.setItem(this.currentUser+"_meds",JSON.stringify(meds));
    this.renderList();
  }

  logout(){
    this.currentUser = null;
    this.showHome();
  }
}

const app = new MedMinder("app");
</script>
</body>
</html>
